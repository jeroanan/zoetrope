function getSortFunc(a,b,c){function d(d){return a[b]=d,d===e?void(a[c]=!a[c]):(e=d,a[b]=d,void(a[c]=!1))}var e=a[b];return d}function getQueryStrings(){var a={},b=function(a){return decodeURIComponent(a.replace(/\+/g," "))},c=location.search.substring(1),d=c.split("&");for(var e in d){var f=d[e].split("=");f.length>1&&(a[b(f[0])]=b(f[1]))}return a}function DiskUsageController(a){function b(){e.ready=!1,e.error=!1,a.get()().query().$promise.then(c,d)}function c(a){e.disk_usages=a,e.ready=!0}function d(){e.ready=!0,e.error=!0}var e=this;e.orderProp="master_url",e.reverseSort=!1,e.ready=!1,e.title="Disk Usage",e.disk_usages={},e.sort=getSortFunc(e,"orderProp","reverseSort"),e.upArrow=upArrow,e.downArrow=downArrow,e.error=!1,e.load=b,document.title=e.title,b()}function IndexController(a,b){function c(){g.ready=!1,g.error=!1,a.get()().query().$promise.then(d,e)}function d(a){g.tasks=a,b.get()().query().$promise.then(f,e)}function e(a){g.error=!0,g.ready=!0}function f(a){function b(a){var b=a.split(":"),c="";for(var d in b)c+=1===b[d].length?"0"+b[d]:b[d],c+=":";return c.slice(0,c.length-1)}g.projects=a;var c=0;g.tasks=g.tasks.map(function(a){return c++,a.idx=c,a.project_name=get_project_name(a,g.projects),a.state=get_state_string(a),a.estimated_cpu_time_remaining=b(a.estimated_cpu_time_remaining),a.time_so_far=b(get_time_so_far(a)),a}),g.ready=!0,g.showRawData=!1,g.title="BOINC Tasks",document.title=g.title}var g=this;g.tasks={},g.projects={},g.sortProp="idx",g.reverseSort=!1,g.ready=!1,g.sort=getSortFunc(g,"sortProp","reverseSort"),g.upArrow=upArrow,g.downArrow=downArrow,g.error=!1,g.load=c,c()}function TaskController(a,b,c,d){function e(){c.get()().query().$promise.then(h,g)}function f(){j.showConfirmAbort=!j.showConfirmAbort}function g(){j.ready=!0,j.error=!0}function h(a){j.task=a,d.get()().query().$promise.then(i,g)}function i(a){j.task.project_name=get_project_name(j.task,a),j.task.state=get_state_string(j.task),j.task.time_so_far=get_time_so_far(j.task),j.suspend_button_text=j.task.suspended_via_gui?"Resume":"Suspend",j.ready=!0}var j=this;j.ready=!1,j.title="Task Summary",j.task={},j.suspend_button_text="",j.error="",j.showConfirmAbort=!1,j.abortButtonClicked=f,j.load=e,document.title=j.title,e()}function ProjectsController(a,b){function c(){h.ready=!1,h.error=!1,a.get()().query().$promise.then(d,e)}function d(a){h.projects=a.filter(function(a){return a.name.length>0}),h.ready=!0}function e(a){h.error=!0,h.ready=!0}function f(a,b){var c=$("#detachModal");h.detachUrl=b,h.detachName=a,c.modal("show")}function g(){b.query(h.project.master_url)().query()}var h=this;h.orderProp="name",h.reverseSort=!1,h.ready=!1,h.showRawData=!1,h.title="BOINC Projects",h.detachClicked=f,h.updateClicked=g,h.detachUrl="",h.detachName="",h.sort=getSortFunc(h,"orderProp","reverseSort"),h.upArrow=upArrow,h.downArrow=downArrow,h.error=!1,h.load=c,document.title=h.title,c()}function ProjectController(a,b,c,d,e){function f(){o.ready=!1,a().query().$promise.then(g,i)}function g(a){o.project=a,n("Project Summary -- "+a.name),c.get(a.master_url)().query().$promise.then(h,i)}function h(a){var b=[];for(var c in a[0]){var d=a[0][c];d.day&&b.push(d)}o.projectStats=b.map(function(a){return a.user_total_credit=parseFloat(a.user_total_credit),a.user_expavg_credit=parseFloat(a.user_expavg_credit),a.host_total_credit=parseFloat(a.host_total_credit),a.host_expavg_credit=parseFloat(a.host_expavg_credit),a}),o.projectFound=!0,o.ready=!0}function i(){o.ready=!0,o.projectFound=!1}function j(){o.ready===!0&&b.query(o.project.master_url)().query()}function k(){$("#detachModal").modal("show")}function l(){d.query(o.project.master_url)().query().$promise.then(function(){o.project.dont_request_more_work=!0})}function m(){e.query(o.project.master_url)().query().$promise.then(function(){o.project.dont_request_more_work=!1})}function n(a){o.title=a,document.title=o.title}var o=this;o.ready=!1,o.title="",o.projectFound=!1,o.project={},o.projectStats=[],o.statsSortField="day",o.statsReverseSort=!0,o.statsSort=getSortFunc(o,"statsSortField","statsReverseSort"),o.upArrow=upArrow,o.downArrow=downArrow,o.load=f,o.updateProject=j,o.detachClicked=k,o.noMoreWorkClicked=l,o.resumeClicked=m,document.title=o.title,f()}function HostInfoController(a){function b(){vm.ready=!1,vm.error=!1,a.get()().query().$promise.then(c,d)}function c(a){vm.host_info=a,vm.ready=!0}function d(){vm.ready=!0,vm.error=!0}vm=this,vm.ready=!1,vm.title="Host Info",vm.host_info={},vm.error=!1,vm.load=b,document.title=vm.title,b()}function DailyTransferController(a){function b(){e.ready=!1,e.error=!1,a.get()().query().$promise.then(c,d)}function c(a){function b(b){var c=a.map(function(a){return a[b]}),d=c.reduce(function(a,b){return a+b});return Math.round(100*d)/100}e.daily_transfers=a.filter(function(a){return a.date}).map(function(a){var b=a.date.split("-"),c=new Date(b[0],b[1]-1,b[2]);return a.date=c,a}),e.totalUploaded=b("uploaded")+"MB",e.totalDownloaded=b("downloaded")+"MB",e.ready=!0}function d(){e.ready=!0,e.error=!0}var e=this;e.daily_transfers={},e.totalUploaded="",e.totalDownloaded="",e.ready=!1,e.title="Daily Transfer History",e.orderProp="date",e.reverseSort=!0,e.sort=getSortFunc(e,"orderProp","reverseSort"),e.upArrow=upArrow,e.downArrow=downArrow,e.error=!1,e.load=b,document.title=e.title,b()}function MessagesController(a){function b(){f.ready=!1,f.error=!1,a.get()().query().$promise.then(c,d)}function c(a){function b(a){var b=c.filter(function(b){return b==a});return b.length}f.messages=a;var c=a.map(function(a){return a.project_name});f.unique_project_names=c.filter(function(a,b,c){return b==c.indexOf(a)});var d={};for(var e in f.unique_project_names){var g=f.unique_project_names[e];d[g]=b(g)}f.project_name_counts=d,f.ready=!0}function d(){f.ready=!0,f.error=!0}function e(a){return""===a?"(no project)":a}var f=this;f.orderProp="message_number",f.reverseSort=!0,f.filterProp="",f.ready=!1,f.title="Messages",document.title=f.title,f.messages={},f.unique_project_names=[],f.project_name_counts=[],f.get_project_name=e,f.sort=getSortFunc(f,"orderProp","reverseSort"),f.upArrow=upArrow,f.downArrow=downArrow,f.error=!1,f.load=b,b()}function NoticesController(a){function b(){e.ready=!1,e.error=!1,a.get()().query().$promise.then(c,d)}function c(a){e.notices=a,e.ready=!0}function d(){e.ready=!0,e.error=!0}var e=this;e.notices=[],e.title="Notices",e.ready=!1,document.title=e.title,e.error=!1,e.load=b,b()}function GlobalPreferencesCtrl(a){function b(){e.ready=!1,e.error=!1,a.get()().query().$promise.then(c,d)}function c(a){e.prefs=a,e.ready=!0}function d(){e.ready=!0,e.error=!0}var e=this;e.ready=!1,e.title="Global Preferences",e.prefs={},e.error=!1,e.load=b,document.title=e.title,b()}function AllProjectListController(a,b,c){function d(){i.ready=!1,i.error=!1,a.get()().query().$promise.then(e,f)}function e(a){i.allProjects=a,b.get()().query().$promise.then(g,f),c.get()().query().$promise.then(h,f)}function f(){i.ready=!0,i.error=!0}function g(a){i.ready=!0,i.availableProjects=i.allProjects.map(function(b){var c=a.filter(function(a){return a.name==b.name});return b.attached=c.length>0,b})}function h(a){var b=a.platform;i.allProjects=i.allProjects.map(function(a){var c=a.platforms.filter(function(a){return a.name===b});return a.supported=c.length>0,a})}var i=this;i.ready=!1,i.title="All Projects",i.sortProp="name",i.reverseSort=!1,i.availableProjects=null,i.doSort=getSortFunc(i,"sortProp","reverseSort"),i.allProjects=[],i.upArrow=upArrow,i.downArrow=downArrow,i.load=d,document.title=i.title,d()}function ProjectDetailController(a,b,c){function d(){k.ready=!1,k.error=!1,b.get()().query().$promise.then(e,f)}function e(b){return k.project=b.filter(function(b){return b.name===a.projectname})[0],k.project?(c.get()().query().$promise.then(j,f),i("Project Details -- "+k.project.name),k.projectFound=!0,void(k.ready=!0)):(k.projectFound=!1,void(k.ready=!0))}function f(){k.ready=!0,k.error=!0}function g(){$("#attachModal").modal("show")}function h(){$("#detachModal").modal("show")}function i(a){k.title=a,document.title=k.title}function j(a){var b=a.filter(function(a){return a.name==k.project.name});k.project.attached=b.length>0}var k=this;k.ready=!1,k.project={},k.attachClicked=g,k.detachClicked=h,k.projectFound=!1,k.error=!1,k.load=d,i("Project Details"),d()}function AttachProjectController(a,b,c){function d(a){h.attachedProjects=a.filter(function(a){return a.name.length>0}),h.ready=!0}function e(){if(h.success=!1,h.errorText="",""===h.selectedProject||""===h.emailaddress||""===h.password)return h.success=!1,void(h.errorText="Please enter an email address, password and select a project to attach to.");var b=h.password+h.emailaddress,d=c.query(b)();h.loading=!0,a.query(h.selectedProject,h.emailaddress,d)().query().$promise.then(f)}function f(a){h.loading=!1,h.success=a.success,h.errorText=a.error_message}function g(){h.errorText=""}var h=this;h.selectedProject="",h.emailaddress="",h.password="",h.submitClicked=e,h.ready=!1,h.title="Attach Project",h.errorText="",h.success=!1,h.loading=!1,h.selectedProjectChanged=g,b.get()().query().$promise.then(d),document.title=h.title}function DetachProjectController(a,b){function c(a){h.attachedProjects=a.filter(function(a){return a.name.length>0}),h.ready=!0}function d(){return h.selectedProject?void(h.showConfirmDetach=!0):(h.detachClicked=!0,h.detachSuccessful=!1,void(h.detachErrorMessage="Select a project to detach from first."))}function e(){h.detachClicked=!0,b.query(h.selectedProject)().query().$promise.then(f)}function f(a){h.detachErrorMessage=a.error_message,h.detachSuccessful=a.success}function g(){h.detachErrorMessage="",h.detachClicked=!1,h.showConfirmDetach=!1}var h=this;h.attachedProjects=null,h.ready=!1,h.showConfirmDetach=!1,h.selectedProject=null,h.detachButtonClicked=d,h.detachLinkClicked=e,h.title="Detach Project",h.detachSuccessful=!1,h.detachClicked=!1,h.detachErrorMessage="",h.selectedProjectChanged=g,a.get()().query().$promise.then(c),document.title=h.title}angular.module("zoetropeControllers",["ngRoute","ngSanitize","zoetropeServices"]);var upArrow="&#x25B2;",downArrow="&#x25BC;",get_project_name=function(a,b){for(var c in b){var d=b[c];if(d.master_url==a.project_url)return""===d.name?a.project_url:d.name}return a.project_url},get_time_so_far=function(a){return a.ready_to_report?a.final_cpu_time:a.current_cpu_time},get_state_string=function(a){if(a.suspended_via_gui)return"Task suspended by user";if(2===a.state&&(1===a.scheduler_state||0===a.active_task_state))return"Waiting to run";switch(a.state){case 2:return"Running";case 3:return"Computation error";case 5:return"Ready to report";case 6:return"Aborted by user";default:return a.state}};angular.module("zoetropeControllers").directive("keyvalrow",function(){return{restrict:"E",scope:{key:"@",val:"@"},templateUrl:"/static/directives/keyvalrow.html"}}),angular.module("zoetropeControllers").directive("keyvallinkrow",function(){return{restrict:"E",scope:{key:"@",link:"@",text:"@"},templateUrl:"/static/directives/keyvallinkrow.html"}}),angular.module("zoetropeControllers").directive("attachDialog",function(){return{restrict:"E",scope:{projecturl:"@",projectname:"@"},templateUrl:"/static/directives/attachDialog.html",controller:["$scope","attachProjectSvc","md5Svc",function(a,b,c){function d(){if(a.errorText="",a.success=!1,""===a.password||""===a.emailaddress)return void(a.errorText="Please enter an email address and password to attach to this project.");var d=a.password+a.emailaddress,e=c.query(d)();a.loading=!0,b.query(a.projecturl,a.emailaddress,e)().query().$promise.then(function(b){a.loading=!1,b.error_message&&""!==b.error_message?a.errorText=b.error_message:a.success=!0})}a.emailaddress="",a.password="",a.submitClicked=d,a.errorText="",a.success=!1,a.loading=!1}],link:function(a,b,c,d){}}}),angular.module("zoetropeControllers").directive("detachDialog",function(){return{restrict:"E",templateUrl:"/static/directives/detachDialog.html",controller:["$scope","detachProjectSvc",function(a,b){function c(){a.errorText="",b.query(a.projecturl)().query().$promise.then(function(b){b.error_message?a.errorText=b.error_message:$("#detachModal").modal("hide")})}a.submitClicked=c,a.errorText="",a.projecturl="",a.projectname=""}],link:function(a,b,c,d){c.$observe("projecturl",function(b){a.projecturl=b}),c.$observe("projectname",function(b){a.projectname=b})}}}),angular.module("zoetropeControllers").controller("DiskUsageCtrl",DiskUsageController),DiskUsageController.$inject=["diskUsageSvc"],angular.module("zoetropeControllers").controller("IndexCtrl",IndexController),IndexController.$inject=["tasksSvc","projectsSvc"],angular.module("zoetropeControllers").controller("TaskCtrl",TaskController),TaskController.$inject=["$http","$routeParams","taskSvc","projectsSvc"],angular.module("zoetropeControllers").controller("ProjectsCtrl",ProjectsController),ProjectsController.$inject=["projectsSvc","updateProjectSvc"],angular.module("zoetropeControllers").controller("ProjectCtrl",ProjectController),ProjectController.$inject=["projectSvc","updateProjectSvc","statisicsSvc","noMoreWorkSvc","allowMoreWorkSvc"],angular.module("zoetropeControllers").controller("HostInfoCtrl",HostInfoController),HostInfoController.$inject=["hostInfoSvc"],angular.module("zoetropeControllers").controller("DailyTransferCtrl",DailyTransferController),DailyTransferController.$inject=["dailyTransferHistorySvc"],angular.module("zoetropeControllers").controller("MessagesCtrl",MessagesController),MessagesController.$inject=["messagesSvc"],angular.module("zoetropeControllers").controller("NoticesCtrl",NoticesController),NoticesController.$inject=["noticesSvc"],angular.module("zoetropeControllers").controller("globalPreferencesCtrl",GlobalPreferencesCtrl),GlobalPreferencesCtrl.$inject=["globalPreferencesSvc"],angular.module("zoetropeControllers").controller("allProjectListCtrl",AllProjectListController),AllProjectListController.$inject=["allProjectListSvc","projectsSvc","getPlatformSvc"],angular.module("zoetropeControllers").controller("projectDetailCrl",ProjectDetailController),ProjectDetailController.$inject=["$routeParams","allProjectListSvc","projectsSvc"],angular.module("zoetropeControllers").controller("attachProjectCtrl",AttachProjectController),AttachProjectController.$inject=["attachProjectSvc","allProjectListSvc","md5Svc"],angular.module("zoetropeControllers").controller("detachProjectCtrl",DetachProjectController),DetachProjectController.$inject=["projectsSvc","detachProjectSvc"];
//# sourceMappingURL=controller.js.map