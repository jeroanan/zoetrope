function getQueryStrings(){var a={},b=function(a){return decodeURIComponent(a.replace(/\+/g," "))},c=location.search.substring(1),d=c.split("&");for(var e in d){var f=d[e].split("=");f.length>1&&(a[b(f[0])]=b(f[1]))}return a}function DiskUsageController(a){var b=this;b.orderProp="master_url",b.reverseSort=!1,b.ready=!1,b.title="Disk Usage",b.disk_usages={},document.title=b.title,a.get()().query().$promise.then(function(a){b.disk_usages=a,b.ready=!0})}function IndexController(a,b){function c(a){e.tasks=a,b.get()().query().$promise.then(d)}function d(a){e.projects=a;for(var b=0;b<e.tasks.length;b++)e.tasks[b].idx=b+1,e.tasks[b].project_name=get_project_name(e.tasks[b],e.projects),e.tasks[b].state=get_state_string(e.tasks[b]),e.tasks[b].time_so_far=get_time_so_far(e.tasks[b]);e.ready=!0,e.showRawData=!1,e.title="BOINC Tasks",document.title=e.title}var e=this;e.tasks={},e.projects={},e.sortProp="index",e.reverseSort=!1,e.ready=!1,a.get()().query().$promise.then(c)}function TaskController(a,b,c,d){function e(){i.showConfirmAbort=!i.showConfirmAbort}function f(){var a="Task not found";i.ready=!0,i.error=!0,i.errorMessage=a}function g(a){i.task=a,d.get()().query().$promise.then(h,f)}function h(a){i.task.project_name=get_project_name(i.task,a),i.task.state=get_state_string(i.task),i.task.time_so_far=get_time_so_far(i.task),i.suspend_button_text=i.task.suspended_via_gui?"Resume":"Suspend",i.ready=!0}var i=this;i.ready=!1,i.title="Task Summary",i.task={},i.suspend_button_text="",i.error="",i.errorMessage="",i.showConfirmAbort=!1,i.abortButtonClicked=e,c.get()().query().$promise.then(g,f),document.title=i.title}function ProjectsController(a,b){function c(a,b){var c=$("#detachModal");e.detachUrl=b,e.detachName=a,c.modal("show")}function d(){b.query(e.project.master_url)().query()}var e=this;e.orderProp="name",e.reverseSort=!1,e.ready=!1,e.showRawData=!1,e.title="BOINC Projects",e.detachClicked=c,e.updateClicked=d,e.detachUrl="",e.detachName="",document.title=e.title,a.get()().query().$promise.then(function(a){e.projects=a.filter(function(a){return a.name.length>0}),e.ready=!0})}function ProjectController(a,b,c){function d(a){h.project=a,c.get(a.master_url)().query().$promise.then(function(a){h.projectStats=a[0]}),h.projectFound=!0,h.ready=!0}function e(){h.ready=!0,h.projectFound=!1}function f(){h.ready===!0&&b.query(h.project.master_url)().query()}function g(){$("#detachModal").modal("show")}var h=this;h.ready=!1,h.title="Project Summary",h.updateProject=f,h.detachClicked=g,h.projectFound=!1,h.project={},h.projectStats=[],h.statsSortField="day",h.statsReverseSort=!0,a().query().$promise.then(d,e),document.title=h.title}function HostInfoController(a){vm=this,vm.ready=!1,vm.title="Host Info",vm.host_info={},document.title=vm.title,a.get()().query().$promise.then(function(a){vm.host_info=a,vm.ready=!0})}function DailyTransferController(a){var b=this;b.daily_transfers={},b.totalUploaded="",b.totalDownloaded="",b.ready=!1,b.title="Daily Transfer History",b.orderProp="date",b.reverseSort=!0,document.title=b.title,a.get()().query().$promise.then(function(a){function c(b){var c=Array.map(a,function(a){return a[b]}),d=Array.reduce(c,function(a,b){return a+b});return Math.round(100*d)/100}b.daily_transfers=a.filter(function(a){return a.date}).map(function(a){var b=a.date.split("-"),c=new Date(b[0],b[1]-1,b[2]);return a.date=c,a}),b.totalUploaded=c("uploaded")+"MB",b.totalDownloaded=c("downloaded")+"MB",b.ready=!0})}function MessagesController(a){var b=this;b.orderProp="message_number",b.reverseSort=!0,b.filterProp="",b.ready=!1,b.title="Messages",document.title=b.title,b.messages={},b.unique_project_names=[],b.project_name_counts=[],a.get()().query().$promise.then(function(a){b.messages=a;var c=Array.map(a,function(a){return a.project_name});b.unique_project_names=Array.filter(c,function(a,b,c){return b==c.indexOf(a)});var d=function(a){var b=Array.filter(c,function(b){return b==a});return b.length},e={};for(var f in b.unique_project_names){var g=b.unique_project_names[f];e[g]=d(g)}b.project_name_counts=e,b.ready=!0}),b.get_project_name=function(a){return""===a?"(no project)":a}}function NoticesController(a){var b=this;b.notices=[],b.title="Notices",b.ready=!1,document.title=b.title,a.get()().query().$promise.then(function(a){b.notices=a,b.ready=!0})}function GlobalPreferencesCtrl(a){var b=this;b.ready=!1,b.title="Global Preferences",b.prefs={},document.title=b.title,a.get()().query().$promise.then(function(a){b.prefs=a,b.ready=!0})}function AllProjectListController(a,b){function c(a){f.ready=!0,f.availableProjects=f.allProjects.map(function(b){var c=a.filter(function(a){return a.name==b.name});return b.attached=c.length>0,b})}function d(a){f.allProjects=a,b.get()().query().$promise.then(c)}function e(a){function b(a){return a==c?void(f.reverseSort=!f.reverseSort):(c=a,f.sortProp=a,void(f.reverseSort=!1))}var c=a;return b}var f=this;f.ready=!1,f.title="All Projects",f.sortProp="name",f.reverseSort=!1,f.availableProjects=null,f.doSort=e("name"),f.allProjects=[],document.title=f.title,a.get()().query().$promise.then(d)}function ProjectDetailController(a,b,c){function d(){$("#attachModal").modal("show")}function e(){$("#detachModal").modal("show")}function f(a){i.title=a,document.title=i.title}function g(a){var b=a.filter(function(a){return a.name==i.project.name});i.project.attached=b.length>0}function h(b){return i.project=b.filter(function(b){return b.name===a.projectname})[0],i.project?(c.get()().query().$promise.then(g),f("Project Details -- "+i.project.name),i.projectFound=!0,void(i.ready=!0)):(i.projectFound=!1,void(i.ready=!0))}var i=this;i.ready=!1,i.project={},i.attachClicked=d,i.detachClicked=e,i.projectFound=!1,b.get()().query().$promise.then(h),f("Project Details")}function AttachProjectController(a,b,c){function d(){if(e.success=!1,e.errorText="",""===e.selectedProject||""===e.emailaddress||""===e.password)return e.success=!1,void(e.errorText="Please enter an email address, password and select a project to attach to.");var b=e.password+e.emailaddress,d=c.query(b)();e.loading=!0,a.query(e.selectedProject,e.emailaddress,d)().query().$promise.then(function(a){e.loading=!1,e.success=a.success,e.errorText=a.error_message})}var e=this;e.selectedProject="",e.emailaddress="",e.password="",e.submitClicked=d,e.ready=!1,e.title="Attach Project",e.errorText="",e.success=!1,e.loading=!1,b.get()().query().$promise.then(function(a){e.attachedProjects=a.filter(function(a){return a.name.length>0}),e.ready=!0}),document.title=e.title}function DetachProjectController(a,b){function c(){return e.selectedProject?void(e.showConfirmDetach=!0):(e.detachClicked=!0,e.detachSuccessful=!1,void(e.detachErrorMessage="Select a project to detach from first."))}function d(){e.detachClicked=!0,b.query(e.selectedProject)().query().$promise.then(function(a){e.detachSuccessful=a.success,e.detachErrorMessage=a.error_message})}var e=this;e.attachedProjects=null,e.ready=!1,e.showConfirmDetach=!1,e.selectedProject=null,e.detachButtonClicked=c,e.detachLinkClicked=d,e.title="Detach Project",e.detachSuccessful=!1,e.detachClicked=!1,e.detachErrorMessage="",a.get()().query().$promise.then(function(a){e.attachedProjects=a.filter(function(a){return a.name.length>0}),e.ready=!0}),document.title=e.title}angular.module("zoetropeControllers",["ngRoute","ngSanitize","zoetropeServices"]);var get_project_name=function(a,b){for(var c in b){var d=b[c];if(d.master_url==a.project_url)return""===d.name?a.project_url:d.name}return a.project_url},get_time_so_far=function(a){return a.ready_to_report?a.final_cpu_time:a.current_cpu_time},get_state_string=function(a){if(a.suspended_via_gui)return"Task suspended by user";if(2===a.state&&(1===a.scheduler_state||0===a.active_task_state))return"Waiting to run";switch(a.state){case 2:return"Running";case 3:return"Computation error";case 5:return"Ready to report";case 6:return"Aborted by user";default:return a.state}};angular.module("zoetropeControllers").directive("keyvalrow",function(){return{restrict:"E",scope:{key:"@",val:"@"},templateUrl:"/static/directives/keyvalrow.html"}}),angular.module("zoetropeControllers").directive("keyvallinkrow",function(){return{restrict:"E",scope:{key:"@",link:"@",text:"@"},templateUrl:"/static/directives/keyvallinkrow.html"}}),angular.module("zoetropeControllers").directive("attachDialog",function(){return{restrict:"E",scope:{projecturl:"@",projectname:"@"},templateUrl:"/static/directives/attachDialog.html",controller:["$scope","attachProjectSvc","md5Svc",function(a,b,c){function d(){if(a.errorText="",a.success=!1,""===a.password||""===a.emailaddress)return void(a.errorText="Please enter an email address and password to attach to this project.");var d=a.password+a.emailaddress,e=c.query(d)();a.loading=!0,b.query(a.projecturl,a.emailaddress,e)().query().$promise.then(function(b){a.loading=!1,b.error_message&&""!==b.error_message?a.errorText=b.error_message:a.success=!0})}a.emailaddress="",a.password="",a.submitClicked=d,a.errorText="",a.success=!1,a.loading=!1}],link:function(a,b,c,d){}}}),angular.module("zoetropeControllers").directive("detachDialog",function(){return{restrict:"E",templateUrl:"/static/directives/detachDialog.html",controller:["$scope","detachProjectSvc",function(a,b){function c(){a.errorText="",b.query(a.projecturl)().query().$promise.then(function(b){b.error_message?a.errorText=b.error_message:$("#detachModal").modal("hide")})}a.submitClicked=c,a.errorText="",a.projecturl="",a.projectname=""}],link:function(a,b,c,d){c.$observe("projecturl",function(b){a.projecturl=b}),c.$observe("projectname",function(b){a.projectname=b})}}}),angular.module("zoetropeControllers").controller("DiskUsageCtrl",DiskUsageController),DiskUsageController.$inject=["diskUsageSvc"],angular.module("zoetropeControllers").controller("IndexCtrl",IndexController),IndexController.$inject=["tasksSvc","projectsSvc"],angular.module("zoetropeControllers").controller("TaskCtrl",TaskController),TaskController.$inject=["$http","$routeParams","taskSvc","projectsSvc"],angular.module("zoetropeControllers").controller("ProjectsCtrl",ProjectsController),ProjectsController.$inject=["projectsSvc","updateProjectSvc"],angular.module("zoetropeControllers").controller("ProjectCtrl",ProjectController),ProjectController.$inject=["projectSvc","updateProjectSvc","statisicsSvc"],angular.module("zoetropeControllers").controller("HostInfoCtrl",HostInfoController),HostInfoController.$inject=["hostInfoSvc"],angular.module("zoetropeControllers").controller("DailyTransferCtrl",DailyTransferController),DailyTransferController.$inject=["dailyTransferHistorySvc"],angular.module("zoetropeControllers").controller("MessagesCtrl",MessagesController),MessagesController.$inject=["messagesSvc"],angular.module("zoetropeControllers").controller("NoticesCtrl",NoticesController),NoticesController.$inject=["noticesSvc"],angular.module("zoetropeControllers").controller("globalPreferencesCtrl",GlobalPreferencesCtrl),GlobalPreferencesCtrl.$inject=["globalPreferencesSvc"],angular.module("zoetropeControllers").controller("allProjectListCtrl",AllProjectListController),AllProjectListController.$inject=["allProjectListSvc","projectsSvc"],angular.module("zoetropeControllers").controller("projectDetailCrl",ProjectDetailController),ProjectDetailController.$inject=["$routeParams","allProjectListSvc","projectsSvc"],angular.module("zoetropeControllers").controller("attachProjectCtrl",AttachProjectController),AttachProjectController.$inject=["attachProjectSvc","allProjectListSvc","md5Svc"],angular.module("zoetropeControllers").controller("detachProjectCtrl",DetachProjectController),DetachProjectController.$inject=["projectsSvc","detachProjectSvc"];
//# sourceMappingURL=controller.js.map