function getSortFunc(a,b,c){function d(d){return a[b]=d,d===e?void(a[c]=!a[c]):(e=d,a[b]=d,void(a[c]=!1))}var e=a[b];return d}function getQueryStrings(){var a={},b=function(a){return decodeURIComponent(a.replace(/\+/g," "))},c=location.search.substring(1),d=c.split("&");for(var e in d){var f=d[e].split("=");f.length>1&&(a[b(f[0])]=b(f[1]))}return a}function DiskUsageController(a){function b(a){c.disk_usages=a,c.ready=!0}var c=this;c.orderProp="master_url",c.reverseSort=!1,c.ready=!1,c.title="Disk Usage",c.disk_usages={},c.sort=getSortFunc(c,"orderProp","reverseSort"),document.title=c.title,a.get()().query().$promise.then(b)}function IndexController(a,b){function c(a){e.tasks=a,b.get()().query().$promise.then(d)}function d(a){e.projects=a;for(var b=0;b<e.tasks.length;b++)e.tasks[b].idx=b+1,e.tasks[b].project_name=get_project_name(e.tasks[b],e.projects),e.tasks[b].state=get_state_string(e.tasks[b]),e.tasks[b].time_so_far=get_time_so_far(e.tasks[b]);e.ready=!0,e.showRawData=!1,e.title="BOINC Tasks",document.title=e.title}var e=this;e.tasks={},e.projects={},e.sortProp="index",e.reverseSort=!1,e.ready=!1,e.sort=getSortFunc(e,"sortProp","reverseSort"),a.get()().query().$promise.then(c)}function TaskController(a,b,c,d){function e(){i.showConfirmAbort=!i.showConfirmAbort}function f(){var a="Task not found";i.ready=!0,i.error=!0,i.errorMessage=a}function g(a){i.task=a,d.get()().query().$promise.then(h,f)}function h(a){i.task.project_name=get_project_name(i.task,a),i.task.state=get_state_string(i.task),i.task.time_so_far=get_time_so_far(i.task),i.suspend_button_text=i.task.suspended_via_gui?"Resume":"Suspend",i.ready=!0}var i=this;i.ready=!1,i.title="Task Summary",i.task={},i.suspend_button_text="",i.error="",i.errorMessage="",i.showConfirmAbort=!1,i.abortButtonClicked=e,c.get()().query().$promise.then(g,f),document.title=i.title}function ProjectsController(a,b){function c(a){f.projects=a.filter(function(a){return a.name.length>0}),f.ready=!0}function d(a,b){var c=$("#detachModal");f.detachUrl=b,f.detachName=a,c.modal("show")}function e(){b.query(f.project.master_url)().query()}var f=this;f.orderProp="name",f.reverseSort=!1,f.ready=!1,f.showRawData=!1,f.title="BOINC Projects",f.detachClicked=d,f.updateClicked=e,f.detachUrl="",f.detachName="",f.sort=getSortFunc(f,"orderProp","reverseSort"),document.title=f.title,a.get()().query().$promise.then(c)}function ProjectController(a,b,c){function d(a){i.project=a,c.get(a.master_url)().query().$promise.then(e)}function e(a){var b=[];for(var c in a[0]){var d=a[0][c];d.day&&b.push(d)}i.projectStats=b.map(function(a){return a.user_total_credit=parseFloat(a.user_total_credit),a.user_expavg_credit=parseFloat(a.user_expavg_credit),a.host_total_credit=parseFloat(a.host_total_credit),a.host_expavg_credit=parseFloat(a.host_expavg_credit),a}),i.projectFound=!0,i.ready=!0}function f(){i.ready=!0,i.projectFound=!1}function g(){i.ready===!0&&b.query(i.project.master_url)().query()}function h(){$("#detachModal").modal("show")}var i=this;i.ready=!1,i.title="Project Summary",i.updateProject=g,i.detachClicked=h,i.projectFound=!1,i.project={},i.projectStats=[],i.statsSortField="day",i.statsReverseSort=!0,i.statsSort=getSortFunc(i,"statsSortField","statsReverseSort"),document.title=i.title,a().query().$promise.then(d,f)}function HostInfoController(a){vm=this,vm.ready=!1,vm.title="Host Info",vm.host_info={},document.title=vm.title,a.get()().query().$promise.then(function(a){vm.host_info=a,vm.ready=!0})}function DailyTransferController(a){function b(a){function b(b){var c=a.map(function(a){return a[b]}),d=c.reduce(function(a,b){return a+b});return Math.round(100*d)/100}c.daily_transfers=a.filter(function(a){return a.date}).map(function(a){var b=a.date.split("-"),c=new Date(b[0],b[1]-1,b[2]);return a.date=c,a}),c.totalUploaded=b("uploaded")+"MB",c.totalDownloaded=b("downloaded")+"MB",c.ready=!0}var c=this;c.daily_transfers={},c.totalUploaded="",c.totalDownloaded="",c.ready=!1,c.title="Daily Transfer History",c.orderProp="date",c.reverseSort=!0,c.sort=getSortFunc(c,"orderProp","reverseSort"),document.title=c.title,a.get()().query().$promise.then(b)}function MessagesController(a){function b(a){function b(a){var b=c.filter(function(b){return b==a});return b.length}d.messages=a;var c=a.map(function(a){return a.project_name});d.unique_project_names=c.filter(function(a,b,c){return b==c.indexOf(a)});var e={};for(var f in d.unique_project_names){var g=d.unique_project_names[f];e[g]=b(g)}d.project_name_counts=e,d.ready=!0}function c(a){return""===a?"(no project)":a}var d=this;d.orderProp="message_number",d.reverseSort=!0,d.filterProp="",d.ready=!1,d.title="Messages",document.title=d.title,d.messages={},d.unique_project_names=[],d.project_name_counts=[],d.get_project_name=c,d.sort=getSortFunc(d,"orderProp","reverseSort"),a.get()().query().$promise.then(b)}function NoticesController(a){var b=this;b.notices=[],b.title="Notices",b.ready=!1,document.title=b.title,a.get()().query().$promise.then(function(a){b.notices=a,b.ready=!0})}function GlobalPreferencesCtrl(a){var b=this;b.ready=!1,b.title="Global Preferences",b.prefs={},document.title=b.title,a.get()().query().$promise.then(function(a){b.prefs=a,b.ready=!0})}function AllProjectListController(a,b){function c(a){e.ready=!0,e.availableProjects=e.allProjects.map(function(b){var c=a.filter(function(a){return a.name==b.name});return b.attached=c.length>0,b})}function d(a){e.allProjects=a,b.get()().query().$promise.then(c)}var e=this;e.ready=!1,e.title="All Projects",e.sortProp="name",e.reverseSort=!1,e.availableProjects=null,e.doSort=getSortFunc(e,"sortProp","reverseSort"),e.allProjects=[],document.title=e.title,a.get()().query().$promise.then(d)}function ProjectDetailController(a,b,c){function d(){$("#attachModal").modal("show")}function e(){$("#detachModal").modal("show")}function f(a){i.title=a,document.title=i.title}function g(a){var b=a.filter(function(a){return a.name==i.project.name});i.project.attached=b.length>0}function h(b){return i.project=b.filter(function(b){return b.name===a.projectname})[0],i.project?(c.get()().query().$promise.then(g),f("Project Details -- "+i.project.name),i.projectFound=!0,void(i.ready=!0)):(i.projectFound=!1,void(i.ready=!0))}var i=this;i.ready=!1,i.project={},i.attachClicked=d,i.detachClicked=e,i.projectFound=!1,b.get()().query().$promise.then(h),f("Project Details")}function AttachProjectController(a,b,c){function d(){if(e.success=!1,e.errorText="",""===e.selectedProject||""===e.emailaddress||""===e.password)return e.success=!1,void(e.errorText="Please enter an email address, password and select a project to attach to.");var b=e.password+e.emailaddress,d=c.query(b)();e.loading=!0,a.query(e.selectedProject,e.emailaddress,d)().query().$promise.then(function(a){e.loading=!1,e.success=a.success,e.errorText=a.error_message})}var e=this;e.selectedProject="",e.emailaddress="",e.password="",e.submitClicked=d,e.ready=!1,e.title="Attach Project",e.errorText="",e.success=!1,e.loading=!1,b.get()().query().$promise.then(function(a){e.attachedProjects=a.filter(function(a){return a.name.length>0}),e.ready=!0}),document.title=e.title}function DetachProjectController(a,b){function c(){return e.selectedProject?void(e.showConfirmDetach=!0):(e.detachClicked=!0,e.detachSuccessful=!1,void(e.detachErrorMessage="Select a project to detach from first."))}function d(){e.detachClicked=!0,b.query(e.selectedProject)().query().$promise.then(function(a){e.detachSuccessful=a.success,e.detachErrorMessage=a.error_message})}var e=this;e.attachedProjects=null,e.ready=!1,e.showConfirmDetach=!1,e.selectedProject=null,e.detachButtonClicked=c,e.detachLinkClicked=d,e.title="Detach Project",e.detachSuccessful=!1,e.detachClicked=!1,e.detachErrorMessage="",a.get()().query().$promise.then(function(a){e.attachedProjects=a.filter(function(a){return a.name.length>0}),e.ready=!0}),document.title=e.title}angular.module("zoetropeControllers",["ngRoute","ngSanitize","zoetropeServices"]);var get_project_name=function(a,b){for(var c in b){var d=b[c];if(d.master_url==a.project_url)return""===d.name?a.project_url:d.name}return a.project_url},get_time_so_far=function(a){return a.ready_to_report?a.final_cpu_time:a.current_cpu_time},get_state_string=function(a){if(a.suspended_via_gui)return"Task suspended by user";if(2===a.state&&(1===a.scheduler_state||0===a.active_task_state))return"Waiting to run";switch(a.state){case 2:return"Running";case 3:return"Computation error";case 5:return"Ready to report";case 6:return"Aborted by user";default:return a.state}};angular.module("zoetropeControllers").directive("keyvalrow",function(){return{restrict:"E",scope:{key:"@",val:"@"},templateUrl:"/static/directives/keyvalrow.html"}}),angular.module("zoetropeControllers").directive("keyvallinkrow",function(){return{restrict:"E",scope:{key:"@",link:"@",text:"@"},templateUrl:"/static/directives/keyvallinkrow.html"}}),angular.module("zoetropeControllers").directive("attachDialog",function(){return{restrict:"E",scope:{projecturl:"@",projectname:"@"},templateUrl:"/static/directives/attachDialog.html",controller:["$scope","attachProjectSvc","md5Svc",function(a,b,c){function d(){if(a.errorText="",a.success=!1,""===a.password||""===a.emailaddress)return void(a.errorText="Please enter an email address and password to attach to this project.");var d=a.password+a.emailaddress,e=c.query(d)();a.loading=!0,b.query(a.projecturl,a.emailaddress,e)().query().$promise.then(function(b){a.loading=!1,b.error_message&&""!==b.error_message?a.errorText=b.error_message:a.success=!0})}a.emailaddress="",a.password="",a.submitClicked=d,a.errorText="",a.success=!1,a.loading=!1}],link:function(a,b,c,d){}}}),angular.module("zoetropeControllers").directive("detachDialog",function(){return{restrict:"E",templateUrl:"/static/directives/detachDialog.html",controller:["$scope","detachProjectSvc",function(a,b){function c(){a.errorText="",b.query(a.projecturl)().query().$promise.then(function(b){b.error_message?a.errorText=b.error_message:$("#detachModal").modal("hide")})}a.submitClicked=c,a.errorText="",a.projecturl="",a.projectname=""}],link:function(a,b,c,d){c.$observe("projecturl",function(b){a.projecturl=b}),c.$observe("projectname",function(b){a.projectname=b})}}}),angular.module("zoetropeControllers").controller("DiskUsageCtrl",DiskUsageController),DiskUsageController.$inject=["diskUsageSvc"],angular.module("zoetropeControllers").controller("IndexCtrl",IndexController),IndexController.$inject=["tasksSvc","projectsSvc"],angular.module("zoetropeControllers").controller("TaskCtrl",TaskController),TaskController.$inject=["$http","$routeParams","taskSvc","projectsSvc"],angular.module("zoetropeControllers").controller("ProjectsCtrl",ProjectsController),ProjectsController.$inject=["projectsSvc","updateProjectSvc"],angular.module("zoetropeControllers").controller("ProjectCtrl",ProjectController),ProjectController.$inject=["projectSvc","updateProjectSvc","statisicsSvc"],angular.module("zoetropeControllers").controller("HostInfoCtrl",HostInfoController),HostInfoController.$inject=["hostInfoSvc"],angular.module("zoetropeControllers").controller("DailyTransferCtrl",DailyTransferController),DailyTransferController.$inject=["dailyTransferHistorySvc"],angular.module("zoetropeControllers").controller("MessagesCtrl",MessagesController),MessagesController.$inject=["messagesSvc"],angular.module("zoetropeControllers").controller("NoticesCtrl",NoticesController),NoticesController.$inject=["noticesSvc"],angular.module("zoetropeControllers").controller("globalPreferencesCtrl",GlobalPreferencesCtrl),GlobalPreferencesCtrl.$inject=["globalPreferencesSvc"],angular.module("zoetropeControllers").controller("allProjectListCtrl",AllProjectListController),AllProjectListController.$inject=["allProjectListSvc","projectsSvc"],angular.module("zoetropeControllers").controller("projectDetailCrl",ProjectDetailController),ProjectDetailController.$inject=["$routeParams","allProjectListSvc","projectsSvc"],angular.module("zoetropeControllers").controller("attachProjectCtrl",AttachProjectController),AttachProjectController.$inject=["attachProjectSvc","allProjectListSvc","md5Svc"],angular.module("zoetropeControllers").controller("detachProjectCtrl",DetachProjectController),DetachProjectController.$inject=["projectsSvc","detachProjectSvc"];
//# sourceMappingURL=controller.js.map