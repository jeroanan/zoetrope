function getQueryStrings(){var a={},b=function(a){return decodeURIComponent(a.replace(/\+/g," "))},c=location.search.substring(1),d=c.split("&");for(var e in d){var f=d[e].split("=");f.length>1&&(a[b(f[0])]=b(f[1]))}return a}function DiskUsageController(a){var b=this;a.get()().query().$promise.then(function(a){b.disk_usages=a,b.ready=!0}),b.orderProp="master_url",b.reverseSort=!1,b.ready=!1,b.title="Disk Usage",document.title=b.title}function IndexController(a,b){var c=this;a.get()().query().$promise.then(function(a){c.tasks=a,b.get()().query().$promise.then(function(a){c.projects=a;for(var b=0;b<c.tasks.length;b++)c.tasks[b].idx=b+1,c.tasks[b].project_name=get_project_name(c.tasks[b],c.projects),c.tasks[b].state=get_state_string(c.tasks[b]),c.tasks[b].time_so_far=get_time_so_far(c.tasks[b]);c.ready=!0,c.showRawData=!1,c.title="BOINC Tasks",document.title=c.title})}),c.sortProp="index",c.reverseSort=!1,c.ready=!1}function TaskController(a,b,c,d){var e=this;c.get()().query().$promise.then(function(a){var b=a;d.get()().query().$promise.then(function(a){var c=a;b.project_name=get_project_name(b,c),b.state=get_state_string(b),b.time_so_far=get_time_so_far(b),e.task=b,e.suspend_button_text=b.suspended_via_gui?"Resume":"Suspend",e.ready=!0})}),e.ready=!1,e.title="Task Summary",document.title=e.title}function ProjectsController(a){var b=this;a.get()().query().$promise.then(function(a){b.projects=a.filter(function(a){return a.name.length>0}),b.ready=!0}),b.orderProp="name",b.reverseSort=!1,b.ready=!1,b.showRawData=!1,b.title="BOINC Projects",document.title=b.title}function ProjectController(a,b){function c(){d.ready===!0&&b.query(d.project.master_url)().query()}var d=this;d.ready=!1,d.title="Project Summary",d.updateProject=c,a().query().$promise.then(function(a){d.project=a,d.ready=!0}),document.title=d.title}function HostInfoController(a){vm=this,a.get()().query().$promise.then(function(a){vm.host_info=a,vm.ready=!0}),vm.ready=!1,vm.title="Host Info",document.title=vm.title}function DailyTransferController(a){var b=this;a.get()().query().$promise.then(function(a){for(var c in a){var d=a[c];if(d.date){var e=d.date.split("-"),f=new Date(e[0],e[1]-1,e[2]);a[c].date=f}}var g=function(b){var c=Array.map(a,function(a){return a[b]}),d=Array.reduce(c,function(a,b){return a+b});return Math.round(100*d)/100};b.daily_transfers=a,b.orderProp="date",b.reverseSort=!0,b.totalUploaded=g("uploaded")+"MB",b.totalDownloaded=g("downloaded")+"MB",b.ready=!0,b.title="Daily Transfer History",document.title=b.title}),b.ready=!1}function MessagesController(a){var b=this;a.get()().query().$promise.then(function(a){b.messages=a;var c=Array.map(a,function(a){return a.project_name});b.unique_project_names=Array.filter(c,function(a,b,c){return b==c.indexOf(a)});var d=function(a){var b=Array.filter(c,function(b){return b==a});return b.length},e=new Object;for(upn in b.unique_project_names){var f=b.unique_project_names[upn];e[f]=d(f)}b.project_name_counts=e,b.ready=!0}),b.get_project_name=function(a){return""===a?"(no project)":a},b.orderProp="message_number",b.reverseSort=!0,b.filterProp="",b.ready=!1,b.title="Messages",document.title=b.title}function NoticesController(a){var b=this;b.notices=[],a.get()().query().$promise.then(function(a){b.notices=a,b.ready=!0}),b.title="Notices",b.ready=!1,document.title=b.title}function GlobalPreferencesCtrl(a){var b=this;a.get()().query().$promise.then(function(a){b.prefs=a,b.ready=!0,console.log(b.prefs)}),b.ready=!1,b.title="Global Preferences",document.title=b.title}function AllProjectListController(a){function b(a){function b(a){return a==d?void(c.reverseSort=!c.reverseSort):(d=a,c.sortProp=a,void(c.reverseSort=!1))}var d=a;return b}var c=this;c.ready=!1,c.title="All Projects",c.sortProp="name",c.reverseSort=!1,c.availableProjects=null,c.doSort=b("name"),document.title=c.title,a.get()().query().$promise.then(function(a){c.ready=!0,c.availableProjects=a})}function ProjectDetailController(a,b){function c(a){d.title=a,document.title=d.title}var d=this;d.ready=!1,b.get()().query().$promise.then(function(b){d.project=b.filter(function(b){return b.name===a.projectname})[0],c("Project Details -- "+d.project.name),d.ready=!0}),c("Project Details")}function AttachProjectController(a,b){function c(){var b=d.password+d.emailaddress,c=hex_md5(b);a.query(d.selectedProject,d.emailaddress,c)().query()}var d=this;d.selectedProject="",d.emailaddress="",d.password="",d.submitClicked=c,d.ready=!1,d.title="Attach Project",b.get()().query().$promise.then(function(a){d.attachedProjects=a.filter(function(a){return a.name.length>0}),d.ready=!0}),document.title=d.title}function DetachProjectController(a,b){function c(){return e.selectedProject?void(e.showConfirmDetach=!0):(e.detachClicked=!0,e.detachSuccessful=!1,void(e.detachErrorMessage="Select a project to detach from first."))}function d(){e.detachClicked=!0,b.query(e.selectedProject)().query().$promise.then(function(a){e.detachSuccessful=a.success,e.detachErrorMessage=a.error_message})}var e=this;e.attachedProjects=null,e.ready=!1,e.showConfirmDetach=!1,e.selectedProject=null,e.detachButtonClicked=c,e.detachLinkClicked=d,e.title="Detach Project",e.detachSuccessful=!1,e.detachClicked=!1,e.detachErrorMessage="",a.get()().query().$promise.then(function(a){e.attachedProjects=a.filter(function(a){return a.name.length>0}),e.ready=!0}),document.title=e.title}angular.module("zoetropeControllers",["ngRoute","ngSanitize","zoetropeServices"]);var get_project_name=function(a,b){for(p in b){var c=b[p];if(c.master_url==a.project_url)return""===c.name?a.project_url:c.name}return a.project_url},get_time_so_far=function(a){return a.ready_to_report?a.final_cpu_time:a.current_cpu_time},get_state_string=function(a){if(a.suspended_via_gui)return"Task suspended by user";if(2===a.state&&(1===a.scheduler_state||0===a.active_task_state))return"Waiting to run";switch(a.state){case 2:return"Running";case 3:return"Computation error";case 5:return"Ready to report";case 6:return"Aborted by user";default:return a.state}};angular.module("zoetropeControllers").directive("keyvalrow",function(){return{restrict:"E",scope:{key:"@",val:"@"},templateUrl:"/static/directives/keyvalrow.html"}}),angular.module("zoetropeControllers").controller("DiskUsageCtrl",DiskUsageController),DiskUsageController.$inject=["diskUsageSvc"],angular.module("zoetropeControllers").controller("IndexCtrl",IndexController),IndexController.$inject=["tasksSvc","projectsSvc"],angular.module("zoetropeControllers").controller("TaskCtrl",TaskController),TaskController.$inject=["$http","$routeParams","taskSvc","projectsSvc"],angular.module("zoetropeControllers").controller("ProjectsCtrl",ProjectsController),ProjectsController.$inject=["projectsSvc"],angular.module("zoetropeControllers").controller("ProjectCtrl",ProjectController),ProjectController.$inject=["projectSvc","updateProjectSvc"],angular.module("zoetropeControllers").controller("HostInfoCtrl",HostInfoController),HostInfoController.$inject=["hostInfoSvc"],angular.module("zoetropeControllers").controller("DailyTransferCtrl",DailyTransferController),DailyTransferController.$inject=["dailyTransferHistorySvc"],angular.module("zoetropeControllers").controller("MessagesCtrl",MessagesController),MessagesController.$inject=["messagesSvc"],angular.module("zoetropeControllers").controller("NoticesCtrl",NoticesController),NoticesController.$inject=["noticesSvc"],angular.module("zoetropeControllers").controller("globalPreferencesCtrl",GlobalPreferencesCtrl),GlobalPreferencesCtrl.$inject=["globalPreferencesSvc"],angular.module("zoetropeControllers").controller("allProjectListCtrl",AllProjectListController),AllProjectListController.$inject=["allProjectListSvc"],angular.module("zoetropeControllers").controller("projectDetailCrl",ProjectDetailController),ProjectDetailController.$inject=["$routeParams","allProjectListSvc"],angular.module("zoetropeControllers").controller("attachProjectCtrl",AttachProjectController),AttachProjectController.$inject=["attachProjectSvc","allProjectListSvc"],angular.module("zoetropeControllers").controller("detachProjectCtrl",DetachProjectController),DetachProjectController.$inject=["projectsSvc","detachProjectSvc"];
//# sourceMappingURL=controller.js.map