function addUserController(a){function b(){c.errorText="",c.operationSuccess=null,""!==c.userId&&""!==c.password||(c.operationSuccess=!1,c.errorText="Please enter a username and a password"),a.addUser(c.userId,c.password)().query().$promise.then(function(a){return!a.success&&a.error_message?(c.operationSuccess=!1,void(c.errorText=a.error_message)):void(c.operationSuccess=!0)},function(a){c.operationSuccess=!1,c.errorText=a.statusText})}var c=this;c.title="Add User",c.ready=!0,c.errorText="",c.operationSuccess=null,c.operationSuccessMessage="User added successfully",c.userId="",c.password="",c.submitClicked=b}function AllProjectListController(a,b){function c(){h.ready=!1,h.error=!1,a.getAvailableProjects()().query().$promise.then(d,e)}function d(c){h.allProjects=c,a.getAttachedProjects()().query().$promise.then(f,e),b.getPlatform()().query().$promise.then(g,e)}function e(){h.ready=!0,h.error=!0}function f(a){h.ready=!0,h.availableProjects=h.allProjects.map(function(b){var c=a.filter(function(a){return a.name==b.name});return b.attached=c.length>0,b})}function g(a){var b=a.platform;h.allProjects=h.allProjects.map(function(a){var c=a.platforms.filter(function(a){return a.name===b});return a.supported=c.length>0,a})}var h=this;h.ready=!1,h.title="All Projects",h.sortProp="name",h.reverseSort=!1,h.availableProjects=null,h.sort=getSortFunc(h,"sortProp","reverseSort"),h.allProjects=[],h.load=c,document.title=h.title,c()}function AttachProjectController(a,b){function c(a){g.attachedProjects=a.filter(function(a){return a.name.length>0}),g.ready=!0}function d(){if(g.success=!1,g.errorText="",""===g.selectedProject||""===g.emailaddress||""===g.password)return g.success=!1,void(g.errorText="Please enter an email address, password and select a project to attach to.");var c=g.password+g.emailaddress,d=b.query(c)();g.loading=!0,a.attachProject(g.selectedProject,g.emailaddress,d,"",!1)().query().$promise.then(e)}function e(a){g.loading=!1,g.success=a.success,g.errorText=a.error_message}function f(){g.errorText=""}var g=this;g.selectedProject="",g.emailaddress="",g.password="",g.submitClicked=d,g.ready=!1,g.title="Attach Project",g.errorText="",g.success=!1,g.loading=!1,g.selectedProjectChanged=f,a.getAvailableProjects()().query().$promise.then(c),document.title=g.title}function getSortFunc(a,b,c){function d(d){return a[b]=d,d===e?void(a[c]=!a[c]):(e=d,a[b]=d,void(a[c]=!1))}var e=a[b];return d}function DailyTransferController(a){function b(){e.ready=!1,e.error=!1,a.getDailyTransferHistory()().query().$promise.then(c,d)}function c(a){function b(b){var c=a.map(function(a){return a[b]}),d=c.reduce(function(a,b){return a+b});return Math.round(100*d)/100}e.daily_transfers=a.filter(function(a){return a.date}).map(function(a){var b=a.date.split("-"),c=new Date(b[0],b[1]-1,b[2]);return a.date=c,a}),e.totalUploaded=b("uploaded")+"MB",e.totalDownloaded=b("downloaded")+"MB",e.ready=!0}function d(){e.ready=!0,e.error=!0}var e=this;e.daily_transfers={},e.totalUploaded="",e.totalDownloaded="",e.ready=!1,e.title="Daily Transfer History",e.sortProp="date",e.reverseSort=!0,e.sort=getSortFunc(e,"sortProp","reverseSort"),e.error=!1,e.load=b,document.title=e.title,b()}function DetachProjectController(a){function b(a){g.attachedProjects=a.filter(function(a){return a.name.length>0}),g.ready=!0}function c(){return g.selectedProject?void(g.showConfirmDetach=!0):(g.detachClicked=!0,g.detachSuccessful=!1,void(g.detachErrorMessage="Select a project to detach from first."))}function d(){g.detachClicked=!0,a.detachProject(g.selectedProject)().query().$promise.then(e)}function e(a){g.detachErrorMessage=a.error_message,g.detachSuccessful=a.success}function f(){g.detachErrorMessage="",g.detachClicked=!1,g.showConfirmDetach=!1}var g=this;g.attachedProjects=null,g.ready=!1,g.showConfirmDetach=!1,g.selectedProject=null,g.detachButtonClicked=c,g.detachLinkClicked=d,g.title="Detach Project",g.detachSuccessful=!1,g.detachClicked=!1,g.detachErrorMessage="",g.selectedProjectChanged=f,a.getAttachedProjects()().query().$promise.then(b),document.title=g.title}function DiskUsageController(a){function b(){e.ready=!1,e.error=!1,a.getDiskUsage()().query().$promise.then(c,d)}function c(a){e.disk_usages=a,e.ready=!0}function d(){e.ready=!0,e.error=!0}var e=this;e.sortProp="master_url",e.reverseSort=!1,e.ready=!1,e.title="Disk Usage",e.disk_usages={},e.sort=getSortFunc(e,"sortProp","reverseSort"),e.error=!1,e.load=b,document.title=e.title,b()}function GlobalPreferencesCtrl(a){function b(){e.ready=!1,e.error=!1,a.getGlobalPreferences()().query().$promise.then(c,d)}function c(a){e.prefs=a,e.ready=!0}function d(){e.ready=!0,e.error=!0}var e=this;e.ready=!1,e.title="Global Preferences",e.prefs={},e.error=!1,e.load=b,document.title=e.title,b()}function HostInfoController(a){function b(){vm.ready=!1,vm.error=!1,a.getHostInfo()().query().$promise.then(c,d)}function c(a){a.uptime=a.uptime.split(".")[0],vm.host_info=a,vm.ready=!0}function d(){vm.ready=!0,vm.error=!0}vm=this,vm.ready=!1,vm.title="Host Info",vm.host_info={},vm.error=!1,vm.load=b,document.title=vm.title,b()}function IndexController(a,b){function c(){h.ready=!1,h.error=!1,a.getAllTasks()().query().$promise.then(d,e)}function d(a){h.tasks=a,b.getAttachedProjects()().query().$promise.then(f,e)}function e(a){h.error=!0,h.ready=!0}function f(a){function b(a){var b=a.split(":"),c="";for(var d in b)c+=1===b[d].length?"0"+b[d]:b[d],c+=":";return c.slice(0,c.length-1)}h.projects=a;var c=0;h.tasks=h.tasks.map(function(a){c++,a.idx=c,a.project_name=get_project_name(a,h.projects),a.state=get_state_string(a),a.estimated_cpu_time_remaining=b(a.estimated_cpu_time_remaining),a.time_so_far=b(get_time_so_far(a));var d=!1,e=!1,f=a.report_deadline.split(" ")[0].split("-");if(3===f.length){var g=new Date(f[0],f[1]-1,f[2]),i=new Date;if(i>g)d=!0;else{var j=864e5,k=2,l=g-i;e=j*k>l}}return a.overdue=d,a.deadlineApproaching=e,a}),h.ready=!0,h.showRawData=!1,h.title="BOINC Tasks",document.title=h.title}function g(a){return a.overdue?"text-danger":a.deadlineApproaching?"text-warning":void 0}var h=this;h.tasks={},h.projects={},h.sortProp="idx",h.reverseSort=!1,h.ready=!1,h.sort=getSortFunc(h,"sortProp","reverseSort"),h.error=!1,h.load=c,h.getDeadlineClass=g,c()}function ManageUsersController(){var a=this;a.title="Manage Users"}function MessagesController(a){function b(){f.ready=!1,f.error=!1,a.getMessages()().query().$promise.then(c,d)}function c(a){function b(a){var b=c.filter(function(b){return b==a});return b.length}f.messages=a;var c=a.map(function(a){return a.project_name}),d=c.filter(function(a,b,c){return b==c.indexOf(a)}),e={};for(var g in d){var h=d[g];e[h]=b(h)}f.project_name_counts=e,f.ready=!0}function d(){f.ready=!0,f.error=!0}function e(a){return""===a?"(No project)":a}var f=this;f.sortProp="message_number",f.reverseSort=!0,f.filterProp="",f.ready=!1,f.title="Messages",f.messages={},f.project_name_counts=[],f.get_project_name=e,f.sort=getSortFunc(f,"sortProp","reverseSort"),f.error=!1,f.load=b,document.title=f.title,b()}function MiscConfigController(a,b){function c(){b.set(d.endpoint)}var d=this;d.ready=!0,d.title="Misc Config",document.title=d.title,d.submitClicked=c,d.endpoint=b.get()}function NoticesController(a){function b(){e.ready=!1,e.error=!1,a.getNotices()().query().$promise.then(c,d)}function c(a){e.notices=a,e.ready=!0}function d(){e.ready=!0,e.error=!0}var e=this;e.notices=[],e.title="Notices",e.ready=!1,document.title=e.title,e.error=!1,e.load=b,b()}function ProjectController(a,b,c,d){function e(){q.ready=!1,d.getProject(a.project)().query().$promise.then(f,g)}function f(a){q.project=a,p("Project Summary -- "+a.name),$("#statsRow").append(b('<project-statistics project-url="'+a.master_url+'" />')(c)),q.projectFound=!0,q.ready=!0}function g(){q.ready=!0,q.projectFound=!1}function h(){q.ready===!0&&d.updateProject(q.project.master_url)().query()}function i(){$("#detachModal").modal("show")}function j(){d.noMoreWork(q.project.master_url)().query().$promise.then(function(){q.project.dont_request_more_work=!0})}function k(){d.allowMoreWork(q.project.master_url)().query().$promise.then(function(){q.project.dont_request_more_work=!1})}function l(){d.suspendProject(q.project.master_url)().query().$promise.then(function(){q.project.suspended_via_gui=!0})}function m(){d.resumeProject(q.project.master_url)().query().$promise.then(function(){q.project.suspended_via_gui=!1})}function n(){d.detachWhenDone(q.project.master_url)().query()}function o(){d.dontDetachWhenDone(q.project.master_url)().query()}function p(a){q.title=a,document.title=q.title}var q=this;q.ready=!1,q.title="",q.projectFound=!1,q.project={},q.upArrow=upArrow,q.downArrow=downArrow,q.load=e,q.updateProject=h,q.detachClicked=i,q.noMoreWorkClicked=j,q.allowMoreWorkClicked=k,q.suspendClicked=l,q.resumeClicked=m,q.detachWhenDoneClicked=n,q.dontDetachWhenDoneClicked=o,document.title=q.title,e()}function ProjectDetailController(a,b,c){function d(){l.ready=!1,l.error=!1,b.getAvailableProjects()().query().$promise.then(e,f)}function e(d){return l.project=d.filter(function(b){return b.name===a.projectname})[0],l.project?(b.getAttachedProjects()().query().$promise.then(j,f),c.getPlatform()().query().$promise.then(k,f),i("Project Details -- "+l.project.name),l.projectFound=!0,void(l.ready=!0)):(l.projectFound=!1,void(l.ready=!0))}function f(){l.ready=!0,l.error=!0}function g(){$("#attachModal").modal("show")}function h(){$("#detachModal").modal("show")}function i(a){l.title=a,document.title=l.title}function j(a){var b=a.filter(function(a){return a.name===l.project.name});l.project.attached=b.length>0}function k(a){var b=l.project.platforms.filter(function(b){return b.name===a.platform});l.project.platformSupported=b.length>0,l.gotPlatform=!0;for(var c=$("#supportedPlatforms").children("li:contains("+a.platform+")"),d=0;d<c.length;d++){var e=$(c[d]);e.addClass("text-success"),e.text(e.text()+" âœ”")}}var l=this;l.ready=!1,l.project={},l.attachClicked=g,l.detachClicked=h,l.projectFound=!1,l.error=!1,l.load=d,l.gotPlatform=!1,i("Project Details"),d()}function ProjectsController(a){function b(){j.ready=!1,j.error=!1,a.getAttachedProjects()().query().$promise.then(c,d)}function c(a){j.projects=a.filter(function(a){return a.name.length>0}),j.ready=!0}function d(a){j.error=!0,j.ready=!0}function e(a,b){var c=$("#detachModal");j.detachUrl=b,j.detachName=a,c.modal("show")}function f(b,c,d,e){return function(f){g(),a[b](f)().query().$promise.then(function(){h(c),d&&d&&i(f,d,e)})}}function g(){j.operationSuccess=!1,j.operationSuccessMessage=""}function h(a){j.operationSuccess=!0,j.operationSuccessMessage=a}function i(a,b,c){j.projects=j.projects.map(function(d){return d.master_url!==a?d:(d[b]=c,d)})}var j=this;j.sortProp="name",j.reverseSort=!1,j.ready=!1,j.showRawData=!1,j.title="BOINC Projects",j.detachUrl="",j.detachName="",j.sort=getSortFunc(j,"sortProp","reverseSort"),j.error=!1,j.load=b,j.operationSuccess=!1,j.operationSuccessMessage="",j.detachClicked=e,j.updateClicked=f("updateProject","Project updated successfully"),j.noMoreWorkClicked=f("noMoreWork","New tasks disallowed","dont_request_more_work",!0),j.allowMoreWorkClicked=f("allowMoreWork","New tasks re-allowed","dont_request_more_work",!1),j.suspendProjectClicked=f("suspendProject","Project suspended","suspended_via_gui",!0),j.resumeProjectClicked=f("resumeProject","Project resumed","suspended_via_gui",!1),document.title=j.title,b()}function TaskController(a,b,c,d){function e(){c.getTask(b.task_name)().query().$promise.then(k,j)}function f(){o.showConfirmAbort=!o.showConfirmAbort}function g(a,b,d,e){return function(){h(),c[a](o.task.name)().query().$promise.then(function(){i(b),d&&d&&(o.task[d]=e)})}}function h(){o.operationSuccess=!1,o.operationSuccessMessage=""}function i(a){o.operationSuccess=!0,o.operationSuccessMessage=a}function j(){o.ready=!0,o.error=!0}function k(a){a.truncatedName=a.name.substr(0,20),a.name.length>20&&(a.truncatedName+="..."),a.displayName=a.truncatedName,a.active_task_state=0===a.active_task_state?"Inactive":"Active";var b=!1,c=!1,e=a.report_deadline.split(" ")[0].split("-");if(3===e.length){var f=new Date(e[0],e[1]-1,e[2]),g=new Date;if(g>f)b=!0;else{var h=864e5,i=2,k=f-g;c=h*i>k}}a.overdue=b,a.deadlineApproaching=c,o.task=a,d.getAttachedProjects()().query().$promise.then(l,j)}function l(a){o.task.project_name=get_project_name(o.task,a),o.task.state=get_state_string(o.task),o.task.time_so_far=get_time_so_far(o.task),o.ready=!0}function m(){return o.task.overdue?"text-danger":o.task.deadlineApproaching?"text-warning":void 0}function n(){return o.task.displayName===o.task.name?void(o.task.displayName=o.task.truncatedName):void(o.task.displayName=o.task.name)}var o=this;o.ready=!1,o.title="Task Summary",o.task={},o.error="",o.showConfirmAbort=!1,o.operationSuccess=!1,o.operationSuccessMessage="",o.load=e,o.getDeadlineClass=m,o.taskNameClicked=n,o.suspendClicked=g("suspendTask","Task suspended","suspended_via_gui",!0),o.resumeClicked=g("resumeTask","Task resumed","suspended_via_gui",!1),o.abortTaskLinkClicked=g("abortTask","Task Aborted"),o.abortButtonClicked=f,document.title=o.title,e()}angular.module("zoetropeControllers").controller("addUserCtrl",addUserController),addUserController.$inject=["userSvc"],angular.module("zoetropeControllers").controller("allProjectListCtrl",AllProjectListController),AllProjectListController.$inject=["projectSvc","systemInfoSvc"],angular.module("zoetropeControllers").controller("attachProjectCtrl",AttachProjectController),AttachProjectController.$inject=["projectSvc","md5Svc"];var upArrow="&#x25B2;",downArrow="&#x25BC;",get_project_name=function(a,b){for(var c in b){var d=b[c];if(d.master_url==a.project_url)return""===d.name?a.project_url:d.name}return a.project_url},get_time_so_far=function(a){return a.ready_to_report?a.final_cpu_time:a.current_cpu_time},get_state_string=function(a){if(a.suspended_via_gui)return"Task suspended by user";if(2===a.state&&(1===a.scheduler_state||0===a.active_task_state))return"Waiting to run";switch(a.state){case 2:return"Running";case 3:return"Computation error";case 4:return"Uploading";case 5:return"Ready to report";case 6:return"Aborted by user";default:return a.state}};angular.module("zoetropeControllers").controller("DailyTransferCtrl",DailyTransferController),DailyTransferController.$inject=["systemInfoSvc"],angular.module("zoetropeControllers").controller("detachProjectCtrl",DetachProjectController),DetachProjectController.$inject=["projectSvc"],angular.module("zoetropeControllers").controller("DiskUsageCtrl",DiskUsageController),DiskUsageController.$inject=["systemInfoSvc"],angular.module("zoetropeControllers").controller("globalPreferencesCtrl",GlobalPreferencesCtrl),GlobalPreferencesCtrl.$inject=["systemInfoSvc"],angular.module("zoetropeControllers").controller("HostInfoCtrl",HostInfoController),HostInfoController.$inject=["systemInfoSvc"],angular.module("zoetropeControllers").controller("IndexCtrl",IndexController),IndexController.$inject=["taskSvc","projectSvc"],angular.module("zoetropeControllers").controller("manageUsersCtrl",ManageUsersController),angular.module("zoetropeControllers").controller("MessagesCtrl",MessagesController),MessagesController.$inject=["systemInfoSvc"],angular.module("zoetropeControllers").controller("miscConfigCtrl",MiscConfigController),MiscConfigController.$inject=["messagesSvc","endpointSvc"],angular.module("zoetropeControllers").controller("NoticesCtrl",NoticesController),NoticesController.$inject=["systemInfoSvc"],angular.module("zoetropeControllers").controller("ProjectCtrl",ProjectController),ProjectController.$inject=["$routeParams","$compile","$scope","projectSvc"],angular.module("zoetropeControllers").controller("projectDetailCrl",ProjectDetailController),ProjectDetailController.$inject=["$routeParams","projectSvc","systemInfoSvc"],angular.module("zoetropeControllers").controller("ProjectsCtrl",ProjectsController),ProjectsController.$inject=["projectSvc"],angular.module("zoetropeControllers").controller("TaskCtrl",TaskController),TaskController.$inject=["$http","$routeParams","taskSvc","projectSvc"];
//# sourceMappingURL=controller.js.map