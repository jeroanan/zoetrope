function DiskUsageController(a,b){b.get("/disk_usage_json").success(function(b){a.disk_usages=b,a.ready=!0}),a.orderProp="master_url",a.reverseSort=!1,a.ready=!1,a.title="Disk Usage"}function IndexController(a,b){b.get("/tasks_json").success(function(c){b.get("/projects_json").success(function(b){a.projects=b,a.tasks=c;for(var d=0;d<c.length;d++)c[d].idx=d+1,c[d].project_name=get_project_name(c[d],a.projects),c[d].state=get_state_string(c[d]),c[d].time_so_far=get_time_so_far(c[d]);a.ready=!0,a.showRawData=!1,a.title="BOINC Tasks"})}),a.sortProp="index",a.reverseSort=!1,a.ready=!1}function TaskController(a,b,c){b.get("/task_json?task_name="+c.task_name).then(function(c){var d=c.data;b.get("/projects_json").then(function(b){var c=b.data;a.task=d,d.project_name=get_project_name(d,c),d.state=get_state_string(d),d.time_so_far=get_time_so_far(d),a.suspend_button_text=d.suspended_via_gui?"Resume":"Suspend",a.ready=!0})},function(b){a.error=!0,500===b.status&&(a.errorMessage="Task not found."),a.ready=!0}),a.ready=!1,a.title="Task Summary"}function ProjectsController(a,b){b.get("/projects_json").success(function(b){a.projects=b,a.ready=!0}),a.orderProp="name",a.reverseSort=!1,a.ready=!1,a.showRawData=!1,a.title="BOINC Projects"}function ProjectController(a,b,c){var d=c.project;b.get("/project_json?project="+d).then(function(b){a.project=b.data,a.ready=!0},function(b){a.error=!0,a.errorMessage="Project not found.",a.ready=!0}),a.ready=!1,a.title="Project Summary"}function HostInfoController(a,b){b.get("/host_info_json").success(function(b){a.host_info=b,a.ready=!0}),a.ready=!1,a.title="Host Info"}function DailyTransferController(a,b){b.get("/daily_transfer_history_json").success(function(b){for(var c in b){var d=b[c],e=d.date.split("-"),f=new Date(e[0],e[1]-1,e[2]);b[c].date=f}var g=function(a){var c=Array.map(b,function(b){return b[a]}),d=Array.reduce(c,function(a,b){return a+b});return Math.round(100*d)/100};a.daily_transfers=b,a.orderProp="date",a.reverseSort=!0,a.totalUploaded=g("uploaded")+"MB",a.totalDownloaded=g("downloaded")+"MB",a.ready=!0,a.title="Daily Transfer History"}),a.ready=!1}function MessagesController(a,b){b.get("/messages_json").success(function(b){a.messages=b;var c=Array.map(b,function(a){return a.project_name});a.unique_project_names=Array.filter(c,function(a,b,c){return b==c.indexOf(a)});var d=function(a){var b=Array.filter(c,function(b){return b==a});return b.length},e=new Object;for(upn in a.unique_project_names){var f=a.unique_project_names[upn];e[f]=d(f)}a.project_name_counts=e,a.ready=!0}),a.get_project_name=function(a){return""===a?"(no project)":a},a.orderProp="message_number",a.reverseSort=!0,a.filterProp="",a.ready=!1,a.title="Messages"}function getQueryStrings(){var a={},b=function(a){return decodeURIComponent(a.replace(/\+/g," "))},c=location.search.substring(1),d=c.split("&");for(var e in d){var f=d[e].split("=");f.length>1&&(a[b(f[0])]=b(f[1]))}return a}var zoetropeControllers=angular.module("zoetropeControllers",["ngRoute"]);zoetropeControllers.controller("DiskUsageCtrl",DiskUsageController),DiskUsageController.$inject=["$scope","$http"],zoetropeControllers.controller("IndexCtrl",["$scope","$http",IndexController]),IndexController.$inject=["$scope","$http"],zoetropeControllers.controller("TaskCtrl",TaskController),TaskController.$inject=["$scope","$http","$routeParams"];var get_project_name=function(a,b){for(p in b){var c=b[p];if(c.master_url==a.project_url)return c.name}return""},get_time_so_far=function(a){return a.ready_to_report?a.final_cpu_time:a.current_cpu_time},get_state_string=function(a){if(a.suspended_via_gui)return"Task suspended by user";if(2===a.state&&(1===a.scheduler_state||0===a.active_task_state))return"Waiting to run";switch(a.state){case 2:return"Running";case 3:return"Computation error";case 5:return"Ready to report";case 6:default:return a.state}};zoetropeControllers.controller("ProjectsCtrl",ProjectsController),ProjectsController.$inject=["$scope","$http"],zoetropeControllers.controller("ProjectCtrl",ProjectController),ProjectController.$inject("$scope","$http","$routeParams"),zoetropeControllers.controller("HostInfoCtrl",HostInfoController),HostInfoController.$inject=["$scope","$http"],zoetropeControllers.controller("DailyTransferCtrl",DailyTransferController),DailyTransferController.$inject=["$scope","$http"],zoetropeControllers.controller("MessagesCtrl",MessagesController),MessagesController.$inject=["$scope","$http"],zoetropeControllers.directive("keyvalrow",function(){return{restrict:"E",scope:{key:"@",val:"@"},templateUrl:"/static/directives/keyvalrow.html"}});
//# sourceMappingURL=controller.js.map